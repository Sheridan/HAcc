Типы транзакций:

1. Покупка
Пул:
    Необходимые: дата, покупатель (я), продавец
    Вычисляемые: количество транзакций, общая сумма
Транзакция:
    Необходимые: вещь, количество, сумма
    Вычисляемые: цена за единицу

2. Продажа
Пул:
    Необходимые: дата, продавец (я), покупатель
    Вычисляемые: количество транзакций, общая сумма
Транзакция:
    Необходимые: вещь, количество, сумма
    Вычисляемые: цена за единицу

3. Подарок
Пул:
    Необходимые: дата, дарящий (я), принимающий
    Вычисляемые: средняя сумма
Транзакция:
    Необходимые: вещь
    Вычисляемые: средняя цена

4. Принятие подарка
Пул:
    Необходимые: дата, дарящий, принимающий (я)
    Вычисляемые: количество подарков, общая средняя сумма
Транзакция:
    Необходимые: вещь, количество
    Вычисляемые: средняя цена

5. Внутренний перевод (пул всегда из 2 транзакций)
Пул:
    Необходимые: Дата, источник (я), приемник (я)
    Вычисляемые: Общая сумма
Транзакции:
    1. Сумма
    2. Коммиссия, кому коммисия

6. Приход, зарплата (пул всегда из 2 транзакций)
Пул:
    Необходимые: Дата, источник, приемник (я)
    Вычисляемые: Общая сумма
Транзакции:
    1. Сумма
    2. Коммиссия, кому коммисия
------------------------------------------------------------------------------------------------

Покупка вещи:
    1. Делаем запись о перемещении денег со счета покупателя на счет продавца
    2. Делаем запись о перемещении вещи от продавца к покупателю,
       если вещь - объект или расходник, запись об принятии услуги, если вещь - услуга
    3. Если вещь - расходник или услуга, сразу же делаем запись о списывании вещи
    4. Цепляем соответствующий (объект, расходник, услуга) тег к записи пула,
       к записи транзакции и к записи перемещения вещи
    5. Если вещь - объект, то добавляем каждую единицу вещи в список ценностей и
       назначаем себя владельцем.

Продажа вещи:
    1. Делаем запись о перемещении средств со счета покупателя на счет продавца
    2. Делаем запись о перемещении вещи от продавца к покупателю,
       если вещь - объект или расходник, запись об оказании услуги, если вещь - услуга
    3. Если вещь - расходник или услуга, сразу же делаем запись о списывании вещи
    4. Цепляем соответствующий (объект, расходник, услуга) тег к записи пула,
       к записи транзакции и к записи перемещения вещи
    5. Если вещь - объект, то для каждой затронутой единицы вещи в списке ценностей
       меняем владельца на покупателя

Списывание вещи:
    1. Цепляем тег "Списано"
    2. Назначаем "Ничто" владельцем вещи

Приход денег / расход денег:
    1. Делаем запись о перемещении средств со счета отправителя на счет получателя
       с записью коммиссии, если есть.

Получение подарка:
    1. Покупаем вещь подаркодарителем.
    2. Делаем запись о перемещении вещи от дарител к одаряемому,
       если вещь - объект или расходник, запись о принятии услуги, если вещь - услуга
    3. Если вещь - объект, то добавляем каждую единицу вещи в список ценностей и
       назначаем себя владельцем.

Дарение подарка:
    1. Делаем запись о перемещении вещи от дарител к одаряемому,
       если вещь - объект или расходник, запись о принятии услуги, если вещь - услуга
    2. Если вещь - объект, то меняем у каждой затронутой вещи владельца в ценнотях.
